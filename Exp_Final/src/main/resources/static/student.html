<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å­¦ç”Ÿç«¯ - å­¦ç”Ÿæˆç»©ç®¡ç†ç³»ç»Ÿ</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/dashboard.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .tab-header {
            display: flex;
            margin-bottom: 1.5rem;
            border-bottom: 1px solid var(--border-color);
        }
        .tab-item {
            flex: 1;
            text-align: center;
            padding: 0.75rem;
            cursor: pointer;
            color: var(--text-secondary);
            border-bottom: 2px solid transparent;
        }
        .tab-item.active {
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
            font-weight: 600;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .chart-container {
            position: relative;
            height: 400px;
            margin-top: 20px;
        }
        .report-section {
            margin-top: 2rem;
        }
        .report-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-top: 1.5rem;
        }
        .chart-card {
            background: var(--surface-color);
            border-radius: var(--radius-lg);
            border: 1px solid var(--border-color);
            overflow: hidden;
            transition: var(--transition);
            padding: var(--spacing-lg);
            box-shadow: var(--shadow-sm);
        }
        .chart-card:hover {
            box-shadow: var(--shadow-md);
        }
        .chart-card h4 {
            margin: 0 0 var(--spacing-md) 0;
            color: var(--text-primary);
            font-weight: 600;
            font-size: 1rem;
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="container navbar-content">
            <a href="#" class="logo">ğŸ“ æˆç»©ç®¡ç†ç³»ç»Ÿ</a>
            <div class="user-menu">
                <div class="user-info">
                    <div class="user-name" id="userName">Student Name</div>
                    <div class="user-role">å­¦ç”Ÿ</div>
                </div>
                <button class="btn btn-outline" id="themeToggleBtn" type="button" data-theme-toggle>æš—è‰²</button>
                <button class="btn btn-outline" id="logoutBtn">é€€å‡º</button>
            </div>
        </div>
    </nav>

    <div class="dashboard-layout">
        <aside class="sidebar">
            <div class="sidebar-nav">
                <a href="#" class="nav-item active" data-view="scores">
                    ğŸ“Š æˆ‘çš„æˆç»©
                </a>
                <a href="#" class="nav-item" data-view="course-manage">
                    ğŸ“š é€‰è¯¾ç®¡ç†
                </a>
                <a href="#" class="nav-item" data-view="ai-advisor">
                    ğŸ¤– AI å­¦ä¸šé¡¾é—®
                </a>
                <a href="#" class="nav-item" data-view="profile">
                    ğŸ‘¤ ä¸ªäººä¿¡æ¯
                </a>
            </div>
        </aside>

        <main class="main-content">
            <!-- Loading Indicator -->
            <div id="loading" style="display: none; text-align: center; padding: 2rem;">
                <div class="spinner" style="margin: 0 auto;"></div>
                <p style="margin-top: 1rem; color: var(--text-secondary);">åŠ è½½ä¸­...</p>
            </div>

            <!-- View: My Scores -->
            <div id="view-scores" class="view-section">
                <h2 style="margin-bottom: var(--spacing-lg);">æˆ‘çš„æˆç»©æ¦‚è§ˆ</h2>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-title">å¹³å‡åˆ†</div>
                        <div class="stat-value" id="avgScore">-</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-title">å¹³å‡ç»©ç‚¹</div>
                        <div class="stat-value" id="avgGPA">-</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-title">ä¿®è¯»å­¦åˆ†</div>
                        <div class="stat-value" id="totalCredits">-</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-title">è¯¾ç¨‹æ€»æ•°</div>
                        <div class="stat-value" id="totalCourses">-</div>
                    </div>
                </div>

                <div class="card">
                    <h3 style="margin-bottom: var(--spacing-md);">æˆç»©æ˜ç»†</h3>
                    <div class="table-container">
                        <table id="scoresTable">
                            <thead>
                                <tr>
                                    <th>è¯¾ç¨‹åç§°</th>
                                    <th>å­¦åˆ†</th>
                                    <th>å­¦æœŸ</th>
                                    <th>å¹³æ—¶(20%)</th>
                                    <th>æœŸä¸­(20%)</th>
                                    <th>å®éªŒ(20%)</th>
                                    <th>æœŸæœ«(40%)</th>
                                    <th>æ€»è¯„</th>
                                    <th>ç»©ç‚¹</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Populated by JS -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Report Section -->
                <div class="report-section">
                    <h3 style="margin-bottom: var(--spacing-md);">æˆç»©åˆ†ææŠ¥è¡¨</h3>
                    <div class="chart-container">
                        <canvas id="scoresChart"></canvas>
                    </div>
                    
                    <div class="report-grid">
                        <div class="chart-card">
                            <h4>å­¦ç§‘èƒ½åŠ›é›·è¾¾å›¾</h4>
                            <canvas id="subjectDistributionChart" style="max-height: 300px;"></canvas>
                        </div>
                        <div class="chart-card">
                            <h4>æˆç»©ç­‰çº§ç»Ÿè®¡</h4>
                            <canvas id="gradeDistributionChart" style="max-height: 300px;"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- View: Course Management -->
            <div id="view-course-manage" class="view-section" style="display: none;">
                <h2 style="margin-bottom: var(--spacing-lg);">é€‰è¯¾ç®¡ç†</h2>

                <div class="card">
                    <div class="tab-header">
                        <div class="tab-item active" data-tab="enrollments">å·²é€‰è¯¾ç¨‹</div>
                        <div class="tab-item" data-tab="selection">é€‰è¯¾å¤§å…</div>
                    </div>

                    <!-- Tab: My Enrollments -->
                    <div id="tab-enrollments" class="tab-content active">
                        <p style="color: var(--text-secondary); margin-bottom: var(--spacing-md);">
                            å·²é€‰è¯¾ç¨‹åˆ—è¡¨ã€‚å¦‚éœ€é€€è¯¾ï¼Œè¯·ç‚¹å‡»ç›¸åº”æŒ‰é’®ã€‚
                        </p>
                        <div class="table-container">
                            <table id="enrollmentsTable">
                                <thead>
                                    <tr>
                                        <th>æ•™å­¦ç­å·</th>
                                        <th>è¯¾ç¨‹åç§°</th>
                                        <th>æˆè¯¾æ•™å¸ˆ</th>
                                        <th>å­¦æœŸ</th>
                                        <th>çŠ¶æ€</th>
                                        <th>æ“ä½œ</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Populated by JS -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Tab: Course Selection -->
                    <div id="tab-selection" class="tab-content">
                        <div style="margin-bottom: 1rem; display: flex; gap: 1rem;">
                            <input type="text" id="semesterInput" class="form-control" placeholder="å­¦æœŸ (ä¾‹å¦‚: 2023-2024-1)" style="max-width: 200px;">
                            <button class="btn btn-primary" id="searchCoursesBtn">æŸ¥è¯¢</button>
                        </div>
                        <div class="table-container">
                            <table id="availableCoursesTable">
                                <thead>
                                    <tr>
                                        <th>æ•™å­¦ç­å·</th>
                                        <th>è¯¾ç¨‹åç§°</th>
                                        <th>æˆè¯¾æ•™å¸ˆ</th>
                                        <th>å­¦æœŸ</th>
                                        <th>çŠ¶æ€</th>
                                        <th>å·²é€‰/å®¹é‡</th>
                                        <th>æ“ä½œ</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Populated by JS -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- View: AI Advisor -->
            <div id="view-ai-advisor" class="view-section" style="display: none;">
                <h2 style="margin-bottom: var(--spacing-lg);">AI å­¦ä¸šé¡¾é—®</h2>
                <div class="card">
                    <div class="chat-container">
                        <div class="chat-messages" id="chatMessages">
                            <div class="message ai">
                                ä½ å¥½ï¼æˆ‘æ˜¯ä½ çš„AIå­¦ä¸šé¡¾é—®ã€‚æˆ‘å¯ä»¥æ ¹æ®ä½ çš„æˆç»©æƒ…å†µï¼Œä¸ºä½ æä¾›å­¦ä¹ å»ºè®®ã€åˆ†æè–„å¼±ç¯èŠ‚ã€‚æœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®ä½ çš„å—ï¼Ÿ
                            </div>
                        </div>
                        <div class="chat-input-area">
                            <input type="text" class="chat-input" id="chatInput" placeholder="è¾“å…¥ä½ çš„é—®é¢˜ï¼Œä¾‹å¦‚ï¼šå¦‚ä½•æé«˜æˆ‘çš„Javaæˆç»©ï¼Ÿ">
                            <button class="btn btn-primary" id="sendMessageBtn">å‘é€</button>
                        </div>
                    </div>
                </div>
            </div>


            <!-- View: Profile -->
            <div id="view-profile" class="view-section" style="display: none;">
                <h2 style="margin-bottom: var(--spacing-lg);">ä¸ªäººä¿¡æ¯</h2>
                <div class="card" style="max-width: 600px;">
                    <form id="profileForm">
                        <div class="form-group">
                            <label class="input-label">å­¦å·</label>
                            <input type="text" id="profileStudentNo" class="form-control" disabled>
                        </div>
                        <div class="form-group">
                            <label class="input-label">å§“å</label>
                            <input type="text" id="profileName" class="form-control" disabled>
                        </div>
                        <div class="form-group">
                            <label class="input-label">ç­çº§</label>
                            <input type="text" id="profileClass" class="form-control" disabled>
                        </div>
                        <div class="form-group">
                            <label class="input-label">é‚®ç®±</label>
                            <input type="email" id="profileEmail" name="email" class="form-control">
                        </div>
                        <div class="form-group">
                            <label class="input-label">ç”µè¯</label>
                            <input type="tel" id="profilePhone" name="phone" class="form-control">
                        </div>
                        <button type="submit" class="btn btn-primary">ä¿å­˜ä¿®æ”¹</button>
                    </form>
                </div>
            </div>

        </main>
    </div>

    <script src="js/utils.js"></script>
    <script src="js/api.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="js/student.js"></script>
</body>
</html>
